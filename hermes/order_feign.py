from hermes.config import *
from utils.request_util import *

path = {
    'no_draw_orders': ['/apis/repair/no_draw_orders',
                       ('pcode', 'pdate', 'lotteryId', 'noProcOrderIds', 'incompleteOrders'), 'post',
                       '手动修复未执行开奖流程的订单，并入库', 'OrderFeignResource'],
    'proc_suc_handler': ['/apis/draw/prize/suc/handler/',
                         ('procStatus', 'repairEnter', 'pcode', 'lotteryId', 'prizeStatus'), 'post',
                         '执行开奖后的数据etl', 'OrderFeignResource'],

}


# 每日退佣统计，手动执行
def no_draw_orders(pcode=None, pdate=None, lotteryId=None, no_proc_order_ids=None, incomplete_orders=None):
    pc = PathConfig(path_name='no_draw_orders', path=path, Config=Config)
    params = pc.get_param()
    data = {params[0]: pcode, params[1]: pdate, params[2]: lotteryId, params[3]: no_proc_order_ids,
            params[4]: incomplete_orders}
    return RequestServer(pc, data).request()


# 执行开奖后的数据etl
def proc_suc_handler(pcode=None, lotteryId=None, procStatus=None, prizeStatus=None, repairEnter=None):
    pc = PathConfig(path_name='proc_suc_handler', path=path, Config=Config)
    data = {"pcode": pcode, "lotteryId": lotteryId, "procStatus": procStatus, "prizeStatus": prizeStatus,
            "repairEnter": repairEnter}
    return RequestServer(pc, data).request()


if __name__ == '__main__':
    get_token("plat")
    # Config.env = 'local'
    # token = PathConfig().get_token()
    # print('Bearer', token)
    # 代理每日退佣统计，手动执行

    # result = no_draw_orders(pcode=2018112, pdate=201804, lotteryId=10, no_proc_order_ids=no_proc_order_ids)
    # print(result.text)
    result = proc_suc_handler(procStatus=100, repairEnter="false", pcode=1524655332975, lotteryId=118, prizeStatus=0)
    print(result.text)

    # feign.RetryableException: Read timed out executing POST http://hermes/apis/repair/no_draw_orders?pcode=2018112&pdate=201804&lotteryId=10&noProcOrderIds=210a20181124371g2ail&noProcOrderIds=210a20181124371g2aim&noProcOrderIds=210a20181124371g2ain&noProcOrderIds=210a20181124371g2aio&noProcOrderIds=210a20181124371g2aip&noProcOrderIds=210a20181124371g2aiq&noProcOrderIds=210a20181124371g2air&noProcOrderIds=210a20181124371g2ais&noProcOrderIds=210a20181124371g2ait&noProcOrderIds=210a20181124371g2aiu&noProcOrderIds=210a20181124371g2aiv&noProcOrderIds=220a201811244cf22akn&noProcOrderIds=220a201811244cf22ako&noProcOrderIds=220a201811244cf22akp&noProcOrderIds=220a201811244cf22akq&noProcOrderIds=210a201811244ij62ann&noProcOrderIds=210a201811244ikd2anp&noProcOrderIds=220a201811244jab2anr&noProcOrderIds=210a201811244jc72ant&noProcOrderIds=210a201811244lb42aq3&noProcOrderIds=210a201811244lb42aq4&noProcOrderIds=210a201811244lb42aq5&noProcOrderIds=210a201811244lb42aq6&noProcOrderIds=210a201811244lb42aq7&noProcOrderIds=210a201811244lb42aq8&noProcOrderIds=210a201811244lb42aq9&noProcOrderIds=210a201811244lb42aqa&noProcOrderIds=210a201811244lb42aqb&noProcOrderIds=210a201811244lb92aqd&noProcOrderIds=210a201811244lb92aqe&noProcOrderIds=210a201811244lb92aqf&noProcOrderIds=210a201811244lb92aqg&noProcOrderIds=210a201811244m1e2arp&noProcOrderIds=210a201811244m6k2asv&noProcOrderIds=210a201811244m6k2at0&noProcOrderIds=210a201811244m6k2at1&noProcOrderIds=210a201811244m6k2at2&noProcOrderIds=210a201811244m6k2at3&noProcOrderIds=210a201811244m6k2at4&noProcOrderIds=210a201811244m6k2at5&noProcOrderIds=210a201811244m6k2at6&noProcOrderIds=210a201811244m6k2at7&noProcOrderIds=210a201811244m6k2at8&noProcOrderIds=210a201811244m6k2at9&noProcOrderIds=210a201811244m6k2ata&noProcOrderIds=210a201811244m6k2atb&noProcOrderIds=210a201811244m6s2atd&noProcOrderIds=210a201811244m6s2ate&noProcOrderIds=210a201811244m6s2atf&noProcOrderIds=210a201811244m6s2atg&noProcOrderIds=210a201811244m6s2ath&noProcOrderIds=210a201811244m6s2ati&noProcOrderIds=210a201811244m6s2atj&noProcOrderIds=210a201811244m6s2atk&noProcOrderIds=210a201811244m6s2atl&noProcOrderIds=210a201811244m6s2atm&noProcOrderIds=210a201811244m6s2atn&noProcOrderIds=210a201811244m712atp&noProcOrderIds=210a201811244m712atq&noProcOrderIds=210a201811244m742ats&noProcOrderIds=210a201811244m762atu&noProcOrderIds=210a201811244m762atv&noProcOrderIds=210a201811244m7c2au1&noProcOrderIds=210a201811244m7c2au2&noProcOrderIds=210a201811244m7f2au4&noProcOrderIds=210a201811244m7j2au6&noProcOrderIds=210a201811244m7j2au7&noProcOrderIds=210a201811244m7j2au8&noProcOrderIds=210a201811244m7j2au9&noProcOrderIds=210a201811244m802aub&noProcOrderIds=210a201811244m802auc&noProcOrderIds=210a201811244m802aud&noProcOrderIds=210a201811244m802aue&noProcOrderIds=210a201811244m802auf&noProcOrderIds=210a201811244m802aug&noProcOrderIds=210a201811244m802auh&noProcOrderIds=210a201811244m802aui&noProcOrderIds=210a201811244m9f2auk&noProcOrderIds=210a201811244m9f2aul&noProcOrderIds=210a201811244m9f2aum&noProcOrderIds=210a201811244m9f2aun&noProcOrderIds=210a201811244m9k2aup&noProcOrderIds=210a201811244m9t2aur&noProcOrderIds=210a201811244mft2b08&noProcOrderIds=220a201811244n5k2b57&noProcOrderIds=220a201811244n5k2b58&noProcOrderIds=210a201811244nev2b5a&noProcOrderIds=210a201811244nev2b5b&noProcOrderIds=210a201811244ng22b5d&noProcOrderIds=210a201811244ng22b5e&noProcOrderIds=210a201811244ng92b5g&noProcOrderIds=210a201811244njr2b5i&noProcOrderIds=210a201811244njr2b5j&noProcOrderIds=210a201811244np82b5l&noProcOrderIds=210a201811244ns92b5n&noProcOrderIds=210a201811244nuv2b5r&noProcOrderIds=210a201811244o6a2b5t&noProcOrderIds=210a201811244t812b65&noProcOrderIds=210a201811244tb12b67&noProcOrderIds=210a201811244tdl2b69&noProcOrderIds=220a201811244tgs2b6b&noProcOrderIds=220a201811244thb2b6d&noProcOrderIds=210a201811244tqt2b6h&noProcOrderIds=210a2018112450cm2b6u&noProcOrderIds=220a2018112450j72b70&noProcOrderIds=220a201811245gt22bds&noProcOrderIds=220a201811245gt22bdt&noProcOrderIds=220a201811245gt22bdu&noProcOrderIds=220a201811245gt22bdv&noProcOrderIds=220a201811245gt22be0&noProcOrderIds=220a201811245gt22be1&noProcOrderIds=220a201811245gt22be2&noProcOrderIds=220a201811245gt22be3&noProcOrderIds=220a201811245gt22be4&noProcOrderIds=220a201811245guj2be6&noProcOrderIds=220a201811245guj2be7&noProcOrderIds=220a201811245guq2be9&noProcOrderIds=220a201811245guq2bea&noProcOrderIds=220a201811245h012bec&noProcOrderIds=220a201811245h012bed&noProcOrderIds=220a201811245h012bee&noProcOrderIds=220a201811245h012bef&noProcOrderIds=220a201811245h012beg&noProcOrderIds=220a201811245rgj2bfm&noProcOrderIds=220a201811245rgj2bfn&noProcOrderIds=220a201811245rgr2bfp&noProcOrderIds=220a201811245rgr2bfq&noProcOrderIds=220a201811245rh92bfs&noProcOrderIds=220a201811245rh92bft&noProcOrderIds=220a201811245rh92bfu&noProcOrderIds=220a201811245rh92bfv&noProcOrderIds=220a201811245rhi2bg1&noProcOrderIds=220a201811245rhi2bg2&noProcOrderIds=220a201811245rhi2bg3&noProcOrderIds=220a201811245rhi2bg4&noProcOrderIds=210a201811245rqi2bga&noProcOrderIds=210a201811245rqi2bgb&noProcOrderIds=210a201811245rqi2bgc&noProcOrderIds=210a201811245rqi2bgd&noProcOrderIds=210a201811245rqr2bgf&noProcOrderIds=210a201811245rqr2bgg&noProcOrderIds=210a201811245rqr2bgh&noProcOrderIds=210a201811245rqr2bgi&noProcOrderIds=210a201811245rt02bgk&noProcOrderIds=210a201811245rt02bgl&noProcOrderIds=210a201811245rt02bgm&noProcOrderIds=210a201811245rt02bgn&noProcOrderIds=210a201811245sc62bgu&noProcOrderIds=210a201811245sc62bgv&noProcOrderIds=210a201811245sc62bh0&noProcOrderIds=210a201811245sc62bh1&noProcOrderIds=210a201811245sc62bh2&noProcOrderIds=210a201811245sc62bh3&noProcOrderIds=210a201811245sc62bh4&noProcOrderIds=210a201811245tku2bnk&noProcOrderIds=210a201811245tku2bnl&noProcOrderIds=210a201811245tku2bnm&noProcOrderIds=210a201811245tku2bnn&noProcOrderIds=210a201811245ugs2bo5&noProcOrderIds=210a201811245ugs2bo6&noProcOrderIds=210a201811245uhs2boj&noProcOrderIds=210a2018112464cq2bst&noProcOrderIds=210a2018112464cq2bsu&noProcOrderIds=210a2018112464cq2bsv&noProcOrderIds=210a2018112464cq2bt0&noProcOrderIds=210a2018112464cq2bt1&noProcOrderIds=210a2018112464cq2bt2&noProcOrderIds=210a2018112464cq2bt3&noProcOrderIds=210a2018112464cq2bt4&noProcOrderIds=210a2018112464cq2bt5&noProcOrderIds=210a2018112464cq2bt6&noProcOrderIds=210a2018112464cq2bt7&noProcOrderIds=210a2018112464cq2bt8&noProcOrderIds=210a2018112464cs2bta&noProcOrderIds=210a2018112464d52btj&noProcOrderIds=210a2018112464gf2c06&noProcOrderIds=210a2018112464gf2c07&noProcOrderIds=210a2018112464gf2c08&noProcOrderIds=210a2018112464gf2c09&noProcOrderIds=210a2018112464gf2c0a&noProcOrderIds=210a2018112465a22c1u&noProcOrderIds=210a2018112465a22c1v&noProcOrderIds=210a2018112465a22c20&noProcOrderIds=210a2018112465a22c21&noProcOrderIds=210a2018112465a22c22&noProcOrderIds=210a2018112465a22c23&noProcOrderIds=220a2018112465bn2c2d&noProcOrderIds=220a2018112465bn2c2e&noProcOrderIds=220a2018112465bn2c2f&noProcOrderIds=220a2018112465bu2c2h&noProcOrderIds=220a2018112465bu2c2i&noProcOrderIds=220a2018112465bu2c2j&noProcOrderIds=220a2018112465bu2c2k&noProcOrderIds=220a2018112465cc2c2m&noProcOrderIds=220a2018112465cc2c2n&noProcOrderIds=220a2018112465cc2c2o&noProcOrderIds=220a2018112465cc2c2p&noProcOrderIds=220a2018112465cc2c2q&noProcOrderIds=220a2018112465cc2c2r&noProcOrderIds=220a2018112465cc2c2s
